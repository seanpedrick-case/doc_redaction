<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>App settings management guide – Document Redaction App</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Document Redaction App</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../src/user_guide.html"> 
<span class="menu-text">User guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../src/faq.html"> 
<span class="menu-text">User FAQ</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../src/installation_guide.html"> 
<span class="menu-text">App installation guide (with CDK)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../src/app_settings.html" aria-current="page"> 
<span class="menu-text">App settings management guide</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#app-configuration-file-config.env" id="toc-app-configuration-file-config.env" class="nav-link active" data-scroll-target="#app-configuration-file-config.env">App Configuration File (<code>config.env</code>)</a></li>
  <li><a href="#aws-options" id="toc-aws-options" class="nav-link" data-scroll-target="#aws-options">AWS Options</a></li>
  <li><a href="#image-options" id="toc-image-options" class="nav-link" data-scroll-target="#image-options">Image Options</a></li>
  <li><a href="#file-io-options" id="toc-file-io-options" class="nav-link" data-scroll-target="#file-io-options">File I/O Options</a></li>
  <li><a href="#logging-options" id="toc-logging-options" class="nav-link" data-scroll-target="#logging-options">Logging Options</a></li>
  <li><a href="#gradio-general-app-options" id="toc-gradio-general-app-options" class="nav-link" data-scroll-target="#gradio-general-app-options">Gradio &amp; General App Options</a></li>
  <li><a href="#redaction-pii-options" id="toc-redaction-pii-options" class="nav-link" data-scroll-target="#redaction-pii-options">Redaction &amp; PII Options</a>
  <ul class="collapse">
  <li><a href="#ui-and-model-selection" id="toc-ui-and-model-selection" class="nav-link" data-scroll-target="#ui-and-model-selection">UI and Model Selection</a></li>
  <li><a href="#external-tool-paths" id="toc-external-tool-paths" class="nav-link" data-scroll-target="#external-tool-paths">External Tool Paths</a></li>
  <li><a href="#local-ocr-tesseract-paddleocr" id="toc-local-ocr-tesseract-paddleocr" class="nav-link" data-scroll-target="#local-ocr-tesseract-paddleocr">Local OCR (Tesseract &amp; PaddleOCR)</a></li>
  <li><a href="#vision-language-model-vlm-options" id="toc-vision-language-model-vlm-options" class="nav-link" data-scroll-target="#vision-language-model-vlm-options">Vision Language Model (VLM) Options</a></li>
  <li><a href="#entity-and-search-options" id="toc-entity-and-search-options" class="nav-link" data-scroll-target="#entity-and-search-options">Entity and Search Options</a></li>
  <li><a href="#textract-feature-selection" id="toc-textract-feature-selection" class="nav-link" data-scroll-target="#textract-feature-selection">Textract Feature Selection</a></li>
  <li><a href="#tabular-data-options" id="toc-tabular-data-options" class="nav-link" data-scroll-target="#tabular-data-options">Tabular Data Options</a></li>
  </ul></li>
  <li><a href="#language-options" id="toc-language-options" class="nav-link" data-scroll-target="#language-options">Language Options</a></li>
  <li><a href="#duplicate-detection-settings" id="toc-duplicate-detection-settings" class="nav-link" data-scroll-target="#duplicate-detection-settings">Duplicate Detection Settings</a></li>
  <li><a href="#file-output-options" id="toc-file-output-options" class="nav-link" data-scroll-target="#file-output-options">File Output Options</a></li>
  <li><a href="#direct-mode-lambda-configuration" id="toc-direct-mode-lambda-configuration" class="nav-link" data-scroll-target="#direct-mode-lambda-configuration">Direct Mode &amp; Lambda Configuration</a>
  <ul class="collapse">
  <li><a href="#direct-mode" id="toc-direct-mode" class="nav-link" data-scroll-target="#direct-mode">Direct Mode</a></li>
  <li><a href="#lambda-configuration" id="toc-lambda-configuration" class="nav-link" data-scroll-target="#lambda-configuration">Lambda Configuration</a></li>
  </ul></li>
  <li><a href="#allow-deny-whole-page-redaction-lists" id="toc-allow-deny-whole-page-redaction-lists" class="nav-link" data-scroll-target="#allow-deny-whole-page-redaction-lists">Allow, Deny, &amp; Whole Page Redaction Lists</a></li>
  <li><a href="#cost-code-options" id="toc-cost-code-options" class="nav-link" data-scroll-target="#cost-code-options">Cost Code Options</a></li>
  <li><a href="#whole-document-api-options-textract-async" id="toc-whole-document-api-options-textract-async" class="nav-link" data-scroll-target="#whole-document-api-options-textract-async">Whole Document API Options (Textract Async)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">App settings management guide</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Settings for the redaction app can be set from outside by changing values in the <code>.env</code> file stored in your local config folder, or in S3 if running on AWS. This guide provides an overview of how to configure the application using environment variables. The application loads configurations using <code>os.environ.get()</code>. It first attempts to load variables from the file specified by <code>APP_CONFIG_PATH</code> (which defaults to <code>config/app_config.env</code>). If <code>AWS_CONFIG_PATH</code> is also set (e.g., to <code>config/aws_config.env</code>), variables are loaded from that file as well. Environment variables set directly in the system will always take precedence over those defined in these <code>.env</code> files.</p>
<section id="app-configuration-file-config.env" class="level2">
<h2 class="anchored" data-anchor-id="app-configuration-file-config.env">App Configuration File (<code>config.env</code>)</h2>
<p>This section details variables related to the main application configuration file.</p>
<ul>
<li><strong><code>CONFIG_FOLDER</code></strong>
<ul>
<li><strong>Description:</strong> The folder where configuration files are stored.</li>
<li><strong>Default Value:</strong> <code>config/</code></li>
</ul></li>
<li><strong><code>APP_CONFIG_PATH</code></strong>
<ul>
<li><strong>Description:</strong> Specifies the path to the application configuration <code>.env</code> file. This file contains various settings that control the application’s behavior.</li>
<li><strong>Default Value:</strong> <code>config/app_config.env</code></li>
</ul></li>
</ul>
</section>
<section id="aws-options" class="level2">
<h2 class="anchored" data-anchor-id="aws-options">AWS Options</h2>
<p>This section covers configurations related to AWS services used by the application.</p>
<ul>
<li><strong><code>AWS_CONFIG_PATH</code></strong>
<ul>
<li><strong>Description:</strong> Specifies the path to the AWS configuration <code>.env</code> file. This file is intended to store AWS credentials and specific settings.</li>
<li><strong>Default Value:</strong> <code>''</code> (empty string)</li>
</ul></li>
<li><strong><code>RUN_AWS_FUNCTIONS</code></strong>
<ul>
<li><strong>Description:</strong> Enables or disables AWS-specific functionalities within the application. Set to <code>"True"</code> to enable.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>AWS_REGION</code></strong>
<ul>
<li><strong>Description:</strong> Defines the AWS region where services like S3, Cognito, and Textract are located.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>AWS_CLIENT_ID</code></strong>
<ul>
<li><strong>Description:</strong> The client ID for AWS Cognito, used for user authentication.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>AWS_CLIENT_SECRET</code></strong>
<ul>
<li><strong>Description:</strong> The client secret for AWS Cognito, used in conjunction with the client ID for authentication.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>AWS_USER_POOL_ID</code></strong>
<ul>
<li><strong>Description:</strong> The user pool ID for AWS Cognito, identifying the user directory.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>AWS_ACCESS_KEY</code></strong>
<ul>
<li><strong>Description:</strong> The AWS access key ID for programmatic access to AWS services.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>AWS_SECRET_KEY</code></strong>
<ul>
<li><strong>Description:</strong> The AWS secret access key corresponding to the AWS access key ID.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>DOCUMENT_REDACTION_BUCKET</code></strong>
<ul>
<li><strong>Description:</strong> The name of the S3 bucket used for storing documents related to the redaction process.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>PRIORITISE_SSO_OVER_AWS_ENV_ACCESS_KEYS</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, the app will prioritize using AWS SSO credentials over access keys stored in environment variables.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
<li><strong><code>CUSTOM_HEADER</code></strong>
<ul>
<li><strong>Description:</strong> Specifies a custom header name to be included in requests, often used for services like AWS CloudFront.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>CUSTOM_HEADER_VALUE</code></strong>
<ul>
<li><strong>Description:</strong> The value for the custom header specified by <code>CUSTOM_HEADER</code>.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
</ul>
</section>
<section id="image-options" class="level2">
<h2 class="anchored" data-anchor-id="image-options">Image Options</h2>
<p>Settings related to image processing within the application.</p>
<ul>
<li><strong><code>IMAGES_DPI</code></strong>
<ul>
<li><strong>Description:</strong> Dots Per Inch (DPI) setting for image processing, affecting the resolution and quality of processed images.</li>
<li><strong>Default Value:</strong> <code>'300.0'</code></li>
</ul></li>
<li><strong><code>LOAD_TRUNCATED_IMAGES</code></strong>
<ul>
<li><strong>Description:</strong> Controls whether the application attempts to load truncated images. Set to <code>'True'</code> to enable.</li>
<li><strong>Default Value:</strong> <code>'True'</code></li>
</ul></li>
<li><strong><code>MAX_IMAGE_PIXELS</code></strong>
<ul>
<li><strong>Description:</strong> Sets the maximum number of pixels for an image that the application will process. Leave blank for no limit. This can help prevent issues with very large images.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
</ul>
</section>
<section id="file-io-options" class="level2">
<h2 class="anchored" data-anchor-id="file-io-options">File I/O Options</h2>
<p>Configuration for input and output file handling.</p>
<ul>
<li><strong><code>SESSION_OUTPUT_FOLDER</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>'True'</code>, the application will save output and input files into session-specific subfolders.</li>
<li><strong>Default Value:</strong> <code>'False'</code></li>
</ul></li>
<li><strong><code>OUTPUT_FOLDER</code></strong> (environment variable: <code>GRADIO_OUTPUT_FOLDER</code>)
<ul>
<li><strong>Description:</strong> Specifies the default output folder for generated files. Can be set to <code>"TEMP"</code> to use a temporary directory.</li>
<li><strong>Default Value:</strong> <code>'output/'</code></li>
</ul></li>
<li><strong><code>INPUT_FOLDER</code></strong> (environment variable: <code>GRADIO_INPUT_FOLDER</code>)
<ul>
<li><strong>Description:</strong> Specifies the default input folder for files. Can be set to <code>"TEMP"</code> to use a temporary directory.</li>
<li><strong>Default Value:</strong> <code>'input/'</code></li>
</ul></li>
<li><strong><code>GRADIO_TEMP_DIR</code></strong>
<ul>
<li><strong>Description:</strong> Defines the path for Gradio’s temporary file storage.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>MPLCONFIGDIR</code></strong>
<ul>
<li><strong>Description:</strong> Specifies the cache directory for the Matplotlib library.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
</ul>
</section>
<section id="logging-options" class="level2">
<h2 class="anchored" data-anchor-id="logging-options">Logging Options</h2>
<p>Settings for configuring application logging.</p>
<ul>
<li><strong><code>SAVE_LOGS_TO_CSV</code></strong>
<ul>
<li><strong>Description:</strong> Enables or disables saving logs to CSV files. Set to <code>'True'</code> to enable.</li>
<li><strong>Default Value:</strong> <code>'True'</code></li>
</ul></li>
<li><strong><code>USE_LOG_SUBFOLDERS</code></strong>
<ul>
<li><strong>Description:</strong> If enabled (<code>'True'</code>), logs will be stored in subfolders based on date and hostname.</li>
<li><strong>Default Value:</strong> <code>'True'</code></li>
</ul></li>
<li><strong><code>FEEDBACK_LOGS_FOLDER</code></strong>, <strong><code>ACCESS_LOGS_FOLDER</code></strong>, <strong><code>USAGE_LOGS_FOLDER</code></strong>
<ul>
<li><strong>Description:</strong> Base folders for feedback, access, and usage logs respectively.</li>
<li><strong>Default Values:</strong> <code>'feedback/'</code>, <code>'logs/'</code>, <code>'usage/'</code></li>
</ul></li>
<li><strong><code>S3_FEEDBACK_LOGS_FOLDER</code></strong>, <strong><code>S3_ACCESS_LOGS_FOLDER</code></strong>, <strong><code>S3_USAGE_LOGS_FOLDER</code></strong>
<ul>
<li><strong>Description:</strong> S3 paths where feedback, access, and usage logs will be stored if <code>RUN_AWS_FUNCTIONS</code> is enabled.</li>
<li><strong>Default Values:</strong> Dynamically generated based on date and hostname, e.g., <code>'feedback/YYYYMMDD/hostname/'</code>.</li>
</ul></li>
<li><strong><code>LOG_FILE_NAME</code></strong>, <strong><code>USAGE_LOG_FILE_NAME</code></strong>, <strong><code>FEEDBACK_LOG_FILE_NAME</code></strong>
<ul>
<li><strong>Description:</strong> Specifies the name for log files. <code>USAGE_LOG_FILE_NAME</code> and <code>FEEDBACK_LOG_FILE_NAME</code> default to the value of <code>LOG_FILE_NAME</code>.</li>
<li><strong>Default Value:</strong> <code>'log.csv'</code></li>
</ul></li>
<li><strong><code>DISPLAY_FILE_NAMES_IN_LOGS</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>'True'</code>, file names will be included in log entries.</li>
<li><strong>Default Value:</strong> <code>'False'</code></li>
</ul></li>
<li><strong><code>CSV_ACCESS_LOG_HEADERS</code></strong>, <strong><code>CSV_FEEDBACK_LOG_HEADERS</code></strong>, <strong><code>CSV_USAGE_LOG_HEADERS</code></strong>
<ul>
<li><strong>Description:</strong> Defines custom headers for the respective CSV logs as a string representation of a list. If blank, component labels are used.</li>
<li><strong>Default Value:</strong> Varies; see script for <code>CSV_USAGE_LOG_HEADERS</code> default.</li>
</ul></li>
<li><strong><code>SAVE_LOGS_TO_DYNAMODB</code></strong>
<ul>
<li><strong>Description:</strong> Enables or disables saving logs to AWS DynamoDB. Set to <code>'True'</code> to enable.</li>
<li><strong>Default Value:</strong> <code>'False'</code></li>
</ul></li>
<li><strong><code>ACCESS_LOG_DYNAMODB_TABLE_NAME</code></strong>, <strong><code>FEEDBACK_LOG_DYNAMODB_TABLE_NAME</code></strong>, <strong><code>USAGE_LOG_DYNAMODB_TABLE_NAME</code></strong>
<ul>
<li><strong>Description:</strong> Names of the DynamoDB tables for storing access, feedback, and usage logs.</li>
<li><strong>Default Values:</strong> <code>'redaction_access_log'</code>, <code>'redaction_feedback'</code>, <code>'redaction_usage'</code></li>
</ul></li>
<li><strong><code>DYNAMODB_ACCESS_LOG_HEADERS</code></strong>, <strong><code>DYNAMODB_FEEDBACK_LOG_HEADERS</code></strong>, <strong><code>DYNAMODB_USAGE_LOG_HEADERS</code></strong>
<ul>
<li><strong>Description:</strong> Specifies the headers (attributes) for the respective DynamoDB log tables.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>LOGGING</code></strong>
<ul>
<li><strong>Description:</strong> Enables or disables general console logging. Set to <code>'True'</code> to enable.</li>
<li><strong>Default Value:</strong> <code>'False'</code></li>
</ul></li>
</ul>
</section>
<section id="gradio-general-app-options" class="level2">
<h2 class="anchored" data-anchor-id="gradio-general-app-options">Gradio &amp; General App Options</h2>
<p>Configurations for the Gradio UI, server behavior, and application limits.</p>
<ul>
<li><strong><code>FAVICON_PATH</code></strong>
<ul>
<li><strong>Description:</strong> Path to the favicon icon file for the web interface.</li>
<li><strong>Default Value:</strong> <code>"favicon.png"</code></li>
</ul></li>
<li><strong><code>RUN_FASTAPI</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, the application will be served via FastAPI, allowing for API endpoint integration.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>RUN_MCP_SERVER</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, the application will run as an MCP (Model Context Protocol) server.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>GRADIO_SERVER_NAME</code></strong>
<ul>
<li><strong>Description:</strong> The IP address the Gradio server will bind to. Use <code>"0.0.0.0"</code> to allow external access.</li>
<li><strong>Default Value:</strong> <code>"0.0.0.0"</code></li>
</ul></li>
<li><strong><code>GRADIO_SERVER_PORT</code></strong>
<ul>
<li><strong>Description:</strong> The network port on which the Gradio server will listen.</li>
<li><strong>Default Value:</strong> <code>7860</code></li>
</ul></li>
<li><strong><code>ALLOWED_ORIGINS</code></strong>
<ul>
<li><strong>Description:</strong> A comma-separated list of allowed origins for Cross-Origin Resource Sharing (CORS).</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>ALLOWED_HOSTS</code></strong>
<ul>
<li><strong>Description:</strong> A comma-separated list of allowed hostnames.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>ROOT_PATH</code></strong>
<ul>
<li><strong>Description:</strong> The root path for the application, useful if running behind a reverse proxy (e.g., <code>/app</code>).</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>FASTAPI_ROOT_PATH</code></strong>
<ul>
<li><strong>Description:</strong> The root path for the FastAPI application, used when <code>RUN_FASTAPI</code> is true.</li>
<li><strong>Default Value:</strong> <code>"/"</code></li>
</ul></li>
<li><strong><code>MAX_QUEUE_SIZE</code></strong>
<ul>
<li><strong>Description:</strong> The maximum number of requests that can be queued in the Gradio interface.</li>
<li><strong>Default Value:</strong> <code>5</code></li>
</ul></li>
<li><strong><code>MAX_FILE_SIZE</code></strong>
<ul>
<li><strong>Description:</strong> Maximum file size allowed for uploads (e.g., “250mb”, “1gb”).</li>
<li><strong>Default Value:</strong> <code>'250mb'</code></li>
</ul></li>
<li><strong><code>DEFAULT_CONCURRENCY_LIMIT</code></strong>
<ul>
<li><strong>Description:</strong> The default concurrency limit for Gradio event handlers, controlling how many requests can be processed simultaneously.</li>
<li><strong>Default Value:</strong> <code>3</code></li>
</ul></li>
<li><strong><code>MAX_SIMULTANEOUS_FILES</code></strong>
<ul>
<li><strong>Description:</strong> The maximum number of files that can be processed at once.</li>
<li><strong>Default Value:</strong> <code>10</code></li>
</ul></li>
<li><strong><code>MAX_DOC_PAGES</code></strong>
<ul>
<li><strong>Description:</strong> The maximum number of pages a document can have.</li>
<li><strong>Default Value:</strong> <code>3000</code></li>
</ul></li>
<li><strong><code>MAX_TABLE_ROWS</code></strong> / <strong><code>MAX_TABLE_COLUMNS</code></strong>
<ul>
<li><strong>Description:</strong> Maximum number of rows and columns for tabular data processing.</li>
<li><strong>Default Values:</strong> <code>250000</code> / <code>100</code></li>
</ul></li>
<li><strong><code>MAX_OPEN_TEXT_CHARACTERS</code></strong>
<ul>
<li><strong>Description:</strong> Maximum number of characters for open text input.</li>
<li><strong>Default Value:</strong> <code>50000</code></li>
</ul></li>
<li><strong><code>PAGE_BREAK_VALUE</code></strong>
<ul>
<li><strong>Description:</strong> Number of pages to process before breaking and restarting from the last finished page (not currently activated).</li>
<li><strong>Default Value:</strong> <code>99999</code></li>
</ul></li>
<li><strong><code>MAX_TIME_VALUE</code></strong>
<ul>
<li><strong>Description:</strong> Maximum time value for processing operations.</li>
<li><strong>Default Value:</strong> <code>999999</code></li>
</ul></li>
<li><strong><code>TLDEXTRACT_CACHE</code></strong>
<ul>
<li><strong>Description:</strong> Path to the cache directory used by the <code>tldextract</code> library.</li>
<li><strong>Default Value:</strong> <code>'tmp/tld/'</code></li>
</ul></li>
<li><strong><code>COGNITO_AUTH</code></strong>
<ul>
<li><strong>Description:</strong> Enables or disables AWS Cognito authentication. Set to <code>'True'</code> to enable.</li>
<li><strong>Default Value:</strong> <code>'False'</code></li>
</ul></li>
<li><strong><code>SHOW_FEEDBACK_BUTTONS</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, displays feedback buttons in the Gradio interface.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>USER_GUIDE_URL</code></strong>
<ul>
<li><strong>Description:</strong> A safe URL pointing to the user guide. The URL is validated against a list of allowed domains.</li>
<li><strong>Default Value:</strong> <code>"https://seanpedrick-case.github.io/doc_redaction"</code></li>
</ul></li>
<li><strong><code>INTRO_TEXT</code></strong>
<ul>
<li><strong>Description:</strong> Custom introduction text for the app. Should be in Markdown format, html is stripped out.</li>
<li><strong>Default Value:</strong> <code>"Too long to display here, see tools/config.py"</code></li>
</ul></li>
<li><strong><code>SHOW_EXAMPLES</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, displays example files in the Gradio interface.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
<li><strong><code>SHOW_AWS_EXAMPLES</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, includes AWS-specific examples.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>FILE_INPUT_HEIGHT</code></strong>
<ul>
<li><strong>Description:</strong> Sets the height (in pixels) of the file input component in the Gradio UI.</li>
<li><strong>Default Value:</strong> <code>200</code></li>
</ul></li>
</ul>
</section>
<section id="redaction-pii-options" class="level2">
<h2 class="anchored" data-anchor-id="redaction-pii-options">Redaction &amp; PII Options</h2>
<p>Configurations related to text extraction, PII detection, and the redaction process.</p>
<section id="ui-and-model-selection" class="level3">
<h3 class="anchored" data-anchor-id="ui-and-model-selection">UI and Model Selection</h3>
<ul>
<li><strong><code>EXTRACTION_AND_PII_OPTIONS_OPEN_BY_DEFAULT</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, the “Extraction and PII Options” accordion in the UI will be open by default.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
<li><strong><code>SHOW_LOCAL_TEXT_EXTRACTION_OPTIONS</code></strong> / <strong><code>SHOW_AWS_TEXT_EXTRACTION_OPTIONS</code></strong>
<ul>
<li><strong>Description:</strong> Controls whether local (Tesseract) or AWS (Textract) text extraction options are shown in the UI.</li>
<li><strong>Default Value:</strong> <code>"True"</code> for both.</li>
</ul></li>
<li><strong><code>SELECTABLE_TEXT_EXTRACT_OPTION</code></strong>, <strong><code>TESSERACT_TEXT_EXTRACT_OPTION</code></strong>, <strong><code>TEXTRACT_TEXT_EXTRACT_OPTION</code></strong>
<ul>
<li><strong>Description:</strong> Labels for text extraction model options displayed in the UI. Customize the display names for “Local model - selectable text”, “Local OCR model - PDFs without selectable text”, and “AWS Textract service - all PDF types” respectively.</li>
<li><strong>Default Values:</strong> <code>"Local model - selectable text"</code>, <code>"Local OCR model - PDFs without selectable text"</code>, <code>"AWS Textract service - all PDF types"</code></li>
</ul></li>
<li><strong><code>NO_REDACTION_PII_OPTION</code></strong>, <strong><code>LOCAL_PII_OPTION</code></strong>, <strong><code>AWS_PII_OPTION</code></strong>
<ul>
<li><strong>Description:</strong> Labels for PII detection model options displayed in the UI. Customize the display names for “Only extract text (no redaction)”, “Local”, and “AWS Comprehend” respectively.</li>
<li><strong>Default Values:</strong> <code>"Only extract text (no redaction)"</code>, <code>"Local"</code>, <code>"AWS Comprehend"</code></li>
</ul></li>
<li><strong><code>SHOW_LOCAL_PII_DETECTION_OPTIONS</code></strong> / <strong><code>SHOW_AWS_PII_DETECTION_OPTIONS</code></strong>
<ul>
<li><strong>Description:</strong> Controls whether local or AWS (Comprehend) PII detection options are shown in the UI.</li>
<li><strong>Default Value:</strong> <code>"True"</code> for both.</li>
</ul></li>
<li><strong><code>DEFAULT_TEXT_EXTRACTION_MODEL</code></strong>
<ul>
<li><strong>Description:</strong> Sets the default text extraction model selected in the UI.</li>
<li><strong>Default Value:</strong> Defaults to AWS Textract if available, otherwise local selectable text.</li>
</ul></li>
<li><strong><code>DEFAULT_PII_DETECTION_MODEL</code></strong>
<ul>
<li><strong>Description:</strong> Sets the default PII detection model selected in the UI.</li>
<li><strong>Default Value:</strong> Defaults to AWS Comprehend if available, otherwise the local model.</li>
</ul></li>
<li><strong><code>LOAD_REDACTION_ANNOTATIONS_FROM_PDF</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, the application will load existing redaction annotations from PDFs during the review step.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
</ul>
</section>
<section id="external-tool-paths" class="level3">
<h3 class="anchored" data-anchor-id="external-tool-paths">External Tool Paths</h3>
<ul>
<li><strong><code>TESSERACT_FOLDER</code></strong>
<ul>
<li><strong>Description:</strong> Path to the local Tesseract OCR installation folder.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>TESSERACT_DATA_FOLDER</code></strong>
<ul>
<li><strong>Description:</strong> Path to the Tesseract trained data files (<code>tessdata</code>).</li>
<li><strong>Default Value:</strong> <code>"/usr/share/tessdata"</code></li>
</ul></li>
<li><strong><code>POPPLER_FOLDER</code></strong>
<ul>
<li><strong>Description:</strong> Path to the local Poppler installation’s <code>bin</code> folder.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>PADDLE_MODEL_PATH</code></strong> / <strong><code>SPACY_MODEL_PATH</code></strong>
<ul>
<li><strong>Description:</strong> Custom directory for PaddleOCR and spaCy model storage, useful for environments like AWS Lambda.</li>
<li><strong>Default Value:</strong> <code>''</code> (uses default location).</li>
</ul></li>
</ul>
</section>
<section id="local-ocr-tesseract-paddleocr" class="level3">
<h3 class="anchored" data-anchor-id="local-ocr-tesseract-paddleocr">Local OCR (Tesseract &amp; PaddleOCR)</h3>
<ul>
<li><strong><code>CHOSEN_LOCAL_OCR_MODEL</code></strong>
<ul>
<li><strong>Description:</strong> Choose the engine for local OCR: <code>"tesseract"</code>, <code>"paddle"</code>, or <code>"hybrid-paddle"</code>.</li>
<li><strong>Default Value:</strong> <code>"tesseract"</code></li>
</ul></li>
<li><strong><code>SHOW_LOCAL_OCR_MODEL_OPTIONS</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, allows the user to select the local OCR model from the UI.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>HYBRID_OCR_CONFIDENCE_THRESHOLD</code></strong>
<ul>
<li><strong>Description:</strong> In “hybrid-paddle” mode, this is the Tesseract confidence score below which PaddleOCR will be used for re-extraction.</li>
<li><strong>Default Value:</strong> <code>80</code></li>
</ul></li>
<li><strong><code>HYBRID_OCR_PADDING</code></strong>
<ul>
<li><strong>Description:</strong> In “hybrid-paddle” mode, padding added to the word’s bounding box before re-extraction.</li>
<li><strong>Default Value:</strong> <code>1</code></li>
</ul></li>
<li><strong><code>PADDLE_USE_TEXTLINE_ORIENTATION</code></strong>
<ul>
<li><strong>Description:</strong> Toggles textline orientation detection for PaddleOCR.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>PADDLE_DET_DB_UNCLIP_RATIO</code></strong>
<ul>
<li><strong>Description:</strong> Controls the expansion ratio of the detected text region in PaddleOCR.</li>
<li><strong>Default Value:</strong> <code>1.2</code></li>
</ul></li>
<li><strong><code>SAVE_EXAMPLE_HYBRID_IMAGES</code></strong>
<ul>
<li><strong>Description:</strong> Saves comparison images when using “hybrid-paddle” OCR mode.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>SAVE_PAGE_OCR_VISUALISATIONS</code></strong>
<ul>
<li><strong>Description:</strong> Saves images with PaddleOCR’s detected bounding boxes overlaid.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>SAVE_WORD_SEGMENTER_OUTPUT_IMAGES</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, saves output images from the word segmenter for debugging purposes.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>PREPROCESS_LOCAL_OCR_IMAGES</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, images will be preprocessed before local OCR. Can slow down processing.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
<li><strong><code>SAVE_PREPROCESS_IMAGES</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, saves the preprocessed images for debugging purposes.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>SHOW_PADDLE_MODEL_OPTIONS</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, allows the user to select PaddleOCR-related options (paddle, hybrid-paddle) from the UI.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>MODEL_CACHE_PATH</code></strong>
<ul>
<li><strong>Description:</strong> Path to the directory where models are cached.</li>
<li><strong>Default Value:</strong> <code>"./model_cache"</code></li>
</ul></li>
<li><strong><code>TESSERACT_SEGMENTATION_LEVEL</code></strong>
<ul>
<li><strong>Description:</strong> Tesseract PSM (Page Segmentation Mode) level to use for OCR. Valid values are 0-13.</li>
<li><strong>Default Value:</strong> <code>11</code></li>
</ul></li>
<li><strong><code>TESSERACT_WORD_LEVEL_OCR</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, uses Tesseract word-level OCR instead of line-level.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
<li><strong><code>CONVERT_LINE_TO_WORD_LEVEL</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, converts PaddleOCR line-level OCR results to word-level for better precision.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>LOAD_PADDLE_AT_STARTUP</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, loads the PaddleOCR model at application startup.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
</ul>
</section>
<section id="vision-language-model-vlm-options" class="level3">
<h3 class="anchored" data-anchor-id="vision-language-model-vlm-options">Vision Language Model (VLM) Options</h3>
<ul>
<li><strong><code>SHOW_VLM_MODEL_OPTIONS</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, VLM (Vision Language Model) options will be shown in the UI.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>SELECTED_MODEL</code></strong>
<ul>
<li><strong>Description:</strong> Selected vision model for OCR. Choose from: <code>"Nanonets-OCR2-3B"</code>, <code>"Dots.OCR"</code>, <code>"Qwen3-VL-2B-Instruct"</code>, <code>"Qwen3-VL-4B-Instruct"</code>, <code>"PaddleOCR-VL"</code>.</li>
<li><strong>Default Value:</strong> <code>"Dots.OCR"</code></li>
</ul></li>
<li><strong><code>MAX_SPACES_GPU_RUN_TIME</code></strong>
<ul>
<li><strong>Description:</strong> Maximum number of seconds to run the GPU on Spaces (Hugging Face Spaces).</li>
<li><strong>Default Value:</strong> <code>60</code></li>
</ul></li>
<li><strong><code>MAX_NEW_TOKENS</code></strong>
<ul>
<li><strong>Description:</strong> Maximum number of tokens to generate for VLM responses.</li>
<li><strong>Default Value:</strong> <code>30</code></li>
</ul></li>
<li><strong><code>DEFAULT_MAX_NEW_TOKENS</code></strong>
<ul>
<li><strong>Description:</strong> Default maximum number of tokens to generate for VLM responses.</li>
<li><strong>Default Value:</strong> <code>30</code></li>
</ul></li>
<li><strong><code>MAX_INPUT_TOKEN_LENGTH</code></strong>
<ul>
<li><strong>Description:</strong> Maximum number of tokens that can be input to the VLM.</li>
<li><strong>Default Value:</strong> <code>4096</code></li>
</ul></li>
<li><strong><code>VLM_MAX_IMAGE_SIZE</code></strong>
<ul>
<li><strong>Description:</strong> Maximum total pixels (width * height) for images passed to VLM. Images with more pixels will be resized while maintaining aspect ratio.</li>
<li><strong>Default Value:</strong> <code>1000000</code> (1000x1000)</li>
</ul></li>
<li><strong><code>VLM_MAX_DPI</code></strong>
<ul>
<li><strong>Description:</strong> Maximum DPI for images passed to VLM. Images with higher DPI will be resized accordingly.</li>
<li><strong>Default Value:</strong> <code>300.0</code></li>
</ul></li>
<li><strong><code>USE_FLASH_ATTENTION</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, uses flash attention for the VLM, which can improve performance.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>OVERWRITE_EXISTING_OCR_RESULTS</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, always creates new OCR results instead of loading from existing JSON files.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>SAVE_VLM_INPUT_IMAGES</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, saves input images sent to VLM OCR for debugging purposes.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
</ul>
</section>
<section id="entity-and-search-options" class="level3">
<h3 class="anchored" data-anchor-id="entity-and-search-options">Entity and Search Options</h3>
<ul>
<li><strong><code>CHOSEN_COMPREHEND_ENTITIES</code></strong> / <strong><code>FULL_COMPREHEND_ENTITY_LIST</code></strong>
<ul>
<li><strong>Description:</strong> The selected and available PII entity types for AWS Comprehend.</li>
<li><strong>Default Value:</strong> Predefined lists of entities (see script).</li>
</ul></li>
<li><strong><code>CHOSEN_REDACT_ENTITIES</code></strong> / <strong><code>FULL_ENTITY_LIST</code></strong>
<ul>
<li><strong>Description:</strong> The selected and available PII entity types for the local model.</li>
<li><strong>Default Value:</strong> Predefined lists of entities (see script).</li>
</ul></li>
<li><strong><code>CUSTOM_ENTITIES</code></strong>
<ul>
<li><strong>Description:</strong> A list of entities that are considered “custom” and may have special handling.</li>
<li><strong>Default Value:</strong> <code>['TITLES', 'UKPOSTCODE', 'STREETNAME', 'CUSTOM']</code></li>
</ul></li>
<li><strong><code>DEFAULT_SEARCH_QUERY</code></strong>
<ul>
<li><strong>Description:</strong> The default text for the custom search/redact input box.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>DEFAULT_FUZZY_SPELLING_MISTAKES_NUM</code></strong>
<ul>
<li><strong>Description:</strong> Default number of allowed spelling mistakes for fuzzy searches.</li>
<li><strong>Default Value:</strong> <code>1</code></li>
</ul></li>
<li><strong><code>DEFAULT_PAGE_MIN</code></strong> / <strong><code>DEFAULT_PAGE_MAX</code></strong>
<ul>
<li><strong>Description:</strong> Default start and end pages for processing. <code>0</code> for max means process all pages.</li>
<li><strong>Default Value:</strong> <code>0</code> for both.</li>
</ul></li>
</ul>
</section>
<section id="textract-feature-selection" class="level3">
<h3 class="anchored" data-anchor-id="textract-feature-selection">Textract Feature Selection</h3>
<ul>
<li><strong><code>DEFAULT_HANDWRITE_SIGNATURE_CHECKBOX</code></strong>
<ul>
<li><strong>Description:</strong> The default options selected for Textract’s handwriting and signature detection.</li>
<li><strong>Default Value:</strong> <code>['Extract handwriting']</code></li>
</ul></li>
<li><strong><code>HANDWRITE_SIGNATURE_TEXTBOX_FULL_OPTIONS</code></strong>
<ul>
<li><strong>Description:</strong> Full list of available options for Textract’s handwriting and signature detection. Can include <code>'Extract handwriting'</code>, <code>'Extract signatures'</code>, and optionally <code>'Extract forms'</code>, <code>'Extract layout'</code>, <code>'Extract tables'</code> if the corresponding include options are enabled.</li>
<li><strong>Default Value:</strong> <code>['Extract handwriting', 'Extract signatures']</code></li>
</ul></li>
<li><strong><code>INCLUDE_FORM_EXTRACTION_TEXTRACT_OPTION</code></strong></li>
<li><strong><code>INCLUDE_LAYOUT_EXTRACTION_TEXTRACT_OPTION</code></strong></li>
<li><strong><code>INCLUDE_TABLE_EXTRACTION_TEXTRACT_OPTION</code></strong>
<ul>
<li><strong>Description:</strong> Booleans (<code>"True"</code>/<code>"False"</code>) to include Forms, Layout, and Tables as selectable options for Textract analysis.</li>
<li><strong>Default Value:</strong> <code>"False"</code> for all.</li>
</ul></li>
</ul>
</section>
<section id="tabular-data-options" class="level3">
<h3 class="anchored" data-anchor-id="tabular-data-options">Tabular Data Options</h3>
<ul>
<li><strong><code>DO_INITIAL_TABULAR_DATA_CLEAN</code></strong>
<ul>
<li><strong>Description:</strong> If <code>"True"</code>, performs an initial cleaning step on tabular data.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
<li><strong><code>DEFAULT_TEXT_COLUMNS</code></strong> / <strong><code>DEFAULT_EXCEL_SHEETS</code></strong>
<ul>
<li><strong>Description:</strong> Default values for specifying which columns or sheets to process in tabular files.</li>
<li><strong>Default Value:</strong> <code>[]</code> (empty list)</li>
</ul></li>
<li><strong><code>DEFAULT_TABULAR_ANONYMISATION_STRATEGY</code></strong>
<ul>
<li><strong>Description:</strong> The default method for anonymizing tabular data (e.g., “redact completely”).</li>
<li><strong>Default Value:</strong> <code>"redact completely"</code></li>
</ul></li>
</ul>
</section>
</section>
<section id="language-options" class="level2">
<h2 class="anchored" data-anchor-id="language-options">Language Options</h2>
<p>Settings for multi-language support.</p>
<ul>
<li><strong><code>SHOW_LANGUAGE_SELECTION</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, a language selection dropdown will be visible in the UI.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>DEFAULT_LANGUAGE_FULL_NAME</code></strong> / <strong><code>DEFAULT_LANGUAGE</code></strong>
<ul>
<li><strong>Description:</strong> The default language’s full name (e.g., “english”) and its short code (e.g., “en”).</li>
<li><strong>Default Values:</strong> <code>"english"</code>, <code>"en"</code></li>
</ul></li>
<li><strong><code>textract_language_choices</code></strong> / <strong><code>aws_comprehend_language_choices</code></strong>
<ul>
<li><strong>Description:</strong> Lists of supported language codes for Textract and Comprehend.</li>
<li><strong>Default Value:</strong> <code>['en', 'es', 'fr', 'de', 'it', 'pt']</code> and <code>['en', 'es']</code></li>
</ul></li>
<li><strong><code>MAPPED_LANGUAGE_CHOICES</code></strong> / <strong><code>LANGUAGE_CHOICES</code></strong>
<ul>
<li><strong>Description:</strong> Paired lists of full language names and their corresponding short codes for the UI dropdown.</li>
<li><strong>Default Value:</strong> Predefined lists (see script).</li>
</ul></li>
</ul>
</section>
<section id="duplicate-detection-settings" class="level2">
<h2 class="anchored" data-anchor-id="duplicate-detection-settings">Duplicate Detection Settings</h2>
<ul>
<li><strong><code>DEFAULT_DUPLICATE_DETECTION_THRESHOLD</code></strong>
<ul>
<li><strong>Description:</strong> The similarity score (0.0 to 1.0) above which documents/pages are considered duplicates.</li>
<li><strong>Default Value:</strong> <code>0.95</code></li>
</ul></li>
<li><strong><code>DEFAULT_MIN_CONSECUTIVE_PAGES</code></strong>
<ul>
<li><strong>Description:</strong> Minimum number of consecutive pages that must be duplicates to be flagged.</li>
<li><strong>Default Value:</strong> <code>1</code></li>
</ul></li>
<li><strong><code>USE_GREEDY_DUPLICATE_DETECTION</code></strong>
<ul>
<li><strong>Description:</strong> If <code>"True"</code>, uses a greedy algorithm that may find more duplicates but can be less precise.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
<li><strong><code>DEFAULT_COMBINE_PAGES</code></strong>
<ul>
<li><strong>Description:</strong> If <code>"True"</code>, text from the same page number across different files is combined before checking for duplicates.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
<li><strong><code>DEFAULT_MIN_WORD_COUNT</code></strong>
<ul>
<li><strong>Description:</strong> Pages with fewer words than this value will be ignored by the duplicate detector.</li>
<li><strong>Default Value:</strong> <code>10</code></li>
</ul></li>
<li><strong><code>REMOVE_DUPLICATE_ROWS</code></strong>
<ul>
<li><strong>Description:</strong> If <code>"True"</code>, enables duplicate row detection in tabular data.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
</ul>
</section>
<section id="file-output-options" class="level2">
<h2 class="anchored" data-anchor-id="file-output-options">File Output Options</h2>
<ul>
<li><strong><code>USE_GUI_BOX_COLOURS_FOR_OUTPUTS</code></strong>
<ul>
<li><strong>Description:</strong> If <code>"True"</code>, the final redacted PDF will use the same redaction box colors as shown in the review UI.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>CUSTOM_BOX_COLOUR</code></strong>
<ul>
<li><strong>Description:</strong> Specifies the color for redaction boxes as an RGB tuple string, e.g., <code>"(0, 0, 0)"</code> for black.</li>
<li><strong>Default Value:</strong> <code>"(0, 0, 0)"</code></li>
</ul></li>
<li><strong><code>APPLY_REDACTIONS_IMAGES</code></strong>, <strong><code>APPLY_REDACTIONS_GRAPHICS</code></strong>, <strong><code>APPLY_REDACTIONS_TEXT</code></strong>
<ul>
<li><strong>Description:</strong> Advanced control over how redactions are applied to underlying images, vector graphics, and text in the PDF, based on PyMuPDF options. <code>0</code> is the default for a standard redaction workflow.</li>
<li><strong>Default Value:</strong> <code>0</code> for all.</li>
</ul></li>
<li><strong><code>RETURN_PDF_FOR_REVIEW</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, a PDF with redaction boxes drawn on it (but text not removed) is generated for the “Review” tab.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
<li><strong><code>RETURN_REDACTED_PDF</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>'True'</code>, the application will return a fully redacted PDF at the end of the main task.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
<li><strong><code>COMPRESS_REDACTED_PDF</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>'True'</code>, the redacted PDF output will be compressed.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
</ul>
</section>
<section id="direct-mode-lambda-configuration" class="level2">
<h2 class="anchored" data-anchor-id="direct-mode-lambda-configuration">Direct Mode &amp; Lambda Configuration</h2>
<p>Settings for running the application from the command line (Direct Mode) or as an AWS Lambda function.</p>
<section id="direct-mode" class="level3">
<h3 class="anchored" data-anchor-id="direct-mode">Direct Mode</h3>
<ul>
<li><strong><code>RUN_DIRECT_MODE</code></strong>
<ul>
<li><strong>Description:</strong> Set to <code>'True'</code> to enable direct command-line mode.</li>
<li><strong>Default Value:</strong> <code>'False'</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_DEFAULT_USER</code></strong>
<ul>
<li><strong>Description:</strong> Default username for CLI requests.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_TASK</code></strong>
<ul>
<li><strong>Description:</strong> The task to perform: <code>'redact'</code> or <code>'deduplicate'</code>.</li>
<li><strong>Default Value:</strong> <code>'redact'</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_INPUT_FILE</code></strong> / <strong><code>DIRECT_MODE_OUTPUT_DIR</code></strong>
<ul>
<li><strong>Description:</strong> Path to the input file and output directory for the task.</li>
<li><strong>Default Values:</strong> <code>''</code>, <code>output/</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_DUPLICATE_TYPE</code></strong>
<ul>
<li><strong>Description:</strong> Type of duplicate detection for direct mode: <code>'pages'</code> or <code>'tabular'</code>.</li>
<li><strong>Default Value:</strong> <code>'pages'</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_LANGUAGE</code></strong>
<ul>
<li><strong>Description:</strong> Language for document processing in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>DEFAULT_LANGUAGE</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_PII_DETECTOR</code></strong>
<ul>
<li><strong>Description:</strong> PII detection method for direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>LOCAL_PII_OPTION</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_OCR_METHOD</code></strong>
<ul>
<li><strong>Description:</strong> OCR method for PDF/image processing in direct mode.</li>
<li><strong>Default Value:</strong> <code>"Local OCR"</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_PAGE_MIN</code></strong> / <strong><code>DIRECT_MODE_PAGE_MAX</code></strong>
<ul>
<li><strong>Description:</strong> First and last page to process in direct mode. <code>0</code> for max means process all pages.</li>
<li><strong>Default Values:</strong> Inherit from <code>DEFAULT_PAGE_MIN</code> / <code>DEFAULT_PAGE_MAX</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_IMAGES_DPI</code></strong>
<ul>
<li><strong>Description:</strong> DPI for image processing in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>IMAGES_DPI</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_CHOSEN_LOCAL_OCR_MODEL</code></strong>
<ul>
<li><strong>Description:</strong> Local OCR model choice for direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>CHOSEN_LOCAL_OCR_MODEL</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_PREPROCESS_LOCAL_OCR_IMAGES</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, preprocesses images before OCR in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>PREPROCESS_LOCAL_OCR_IMAGES</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_COMPRESS_REDACTED_PDF</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, compresses the redacted PDF output in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>COMPRESS_REDACTED_PDF</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_RETURN_PDF_END_OF_REDACTION</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, returns a PDF at the end of redaction in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>RETURN_REDACTED_PDF</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_EXTRACT_FORMS</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, extracts forms during Textract analysis in direct mode.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_EXTRACT_TABLES</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, extracts tables during Textract analysis in direct mode.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_EXTRACT_LAYOUT</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, extracts layout during Textract analysis in direct mode.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_EXTRACT_SIGNATURES</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, extracts signatures during Textract analysis in direct mode.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_MATCH_FUZZY_WHOLE_PHRASE_BOOL</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, matches fuzzy whole phrases in direct mode.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_ANON_STRATEGY</code></strong>
<ul>
<li><strong>Description:</strong> Anonymisation strategy for tabular data in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>DEFAULT_TABULAR_ANONYMISATION_STRATEGY</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_FUZZY_MISTAKES</code></strong>
<ul>
<li><strong>Description:</strong> Number of fuzzy spelling mistakes allowed in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>DEFAULT_FUZZY_SPELLING_MISTAKES_NUM</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_SIMILARITY_THRESHOLD</code></strong>
<ul>
<li><strong>Description:</strong> Similarity threshold for duplicate detection in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>DEFAULT_DUPLICATE_DETECTION_THRESHOLD</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_MIN_WORD_COUNT</code></strong>
<ul>
<li><strong>Description:</strong> Minimum word count for duplicate detection in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>DEFAULT_MIN_WORD_COUNT</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_MIN_CONSECUTIVE_PAGES</code></strong>
<ul>
<li><strong>Description:</strong> Minimum consecutive pages for duplicate detection in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>DEFAULT_MIN_CONSECUTIVE_PAGES</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_GREEDY_MATCH</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, uses greedy matching for duplicate detection in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>USE_GREEDY_DUPLICATE_DETECTION</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_COMBINE_PAGES</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, combines pages for duplicate detection in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>DEFAULT_COMBINE_PAGES</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_REMOVE_DUPLICATE_ROWS</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>"True"</code>, removes duplicate rows in tabular data in direct mode.</li>
<li><strong>Default Value:</strong> Inherits from <code>REMOVE_DUPLICATE_ROWS</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_TEXTRACT_ACTION</code></strong>
<ul>
<li><strong>Description:</strong> Textract action for batch operations in direct mode.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>DIRECT_MODE_JOB_ID</code></strong>
<ul>
<li><strong>Description:</strong> Job ID for Textract operations in direct mode.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
</ul>
</section>
<section id="lambda-configuration" class="level3">
<h3 class="anchored" data-anchor-id="lambda-configuration">Lambda Configuration</h3>
<ul>
<li><strong><code>LAMBDA_POLL_INTERVAL</code></strong>
<ul>
<li><strong>Description:</strong> Polling interval in seconds for checking Textract job status.</li>
<li><strong>Default Value:</strong> <code>30</code></li>
</ul></li>
<li><strong><code>LAMBDA_MAX_POLL_ATTEMPTS</code></strong>
<ul>
<li><strong>Description:</strong> Maximum number of polling attempts before timeout.</li>
<li><strong>Default Value:</strong> <code>120</code></li>
</ul></li>
<li><strong><code>LAMBDA_PREPARE_IMAGES</code></strong>
<ul>
<li><strong>Description:</strong> If <code>"True"</code>, prepares images for OCR processing within the Lambda environment.</li>
<li><strong>Default Value:</strong> <code>"True"</code></li>
</ul></li>
<li><strong><code>LAMBDA_EXTRACT_SIGNATURES</code></strong>
<ul>
<li><strong>Description:</strong> Enables signature extraction during Textract analysis in Lambda.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>LAMBDA_DEFAULT_USERNAME</code></strong>
<ul>
<li><strong>Description:</strong> Default username for operations initiated by Lambda.</li>
<li><strong>Default Value:</strong> <code>"lambda_user"</code></li>
</ul></li>
</ul>
</section>
</section>
<section id="allow-deny-whole-page-redaction-lists" class="level2">
<h2 class="anchored" data-anchor-id="allow-deny-whole-page-redaction-lists">Allow, Deny, &amp; Whole Page Redaction Lists</h2>
<ul>
<li><strong><code>GET_DEFAULT_ALLOW_LIST</code></strong>, <strong><code>GET_DEFAULT_DENY_LIST</code></strong>, <strong><code>GET_DEFAULT_WHOLE_PAGE_REDACTION_LIST</code></strong>
<ul>
<li><strong>Description:</strong> Booleans (<code>"True"</code>/<code>"False"</code>) to enable the use of allow, deny, or whole-page redaction lists.</li>
<li><strong>Default Value:</strong> <code>"False"</code></li>
</ul></li>
<li><strong><code>ALLOW_LIST_PATH</code></strong>, <strong><code>DENY_LIST_PATH</code></strong>, <strong><code>WHOLE_PAGE_REDACTION_LIST_PATH</code></strong>
<ul>
<li><strong>Description:</strong> Local paths to the respective CSV list files.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>S3_ALLOW_LIST_PATH</code></strong>, <strong><code>S3_DENY_LIST_PATH</code></strong>, <strong><code>S3_WHOLE_PAGE_REDACTION_LIST_PATH</code></strong>
<ul>
<li><strong>Description:</strong> Paths to the respective list files within the <code>DOCUMENT_REDACTION_BUCKET</code>.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
</ul>
</section>
<section id="cost-code-options" class="level2">
<h2 class="anchored" data-anchor-id="cost-code-options">Cost Code Options</h2>
<ul>
<li><strong><code>SHOW_COSTS</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>'True'</code>, cost-related information will be displayed in the UI.</li>
<li><strong>Default Value:</strong> <code>'False'</code></li>
</ul></li>
<li><strong><code>GET_COST_CODES</code></strong>
<ul>
<li><strong>Description:</strong> Enables fetching and using cost codes. Set to <code>'True'</code> to enable.</li>
<li><strong>Default Value:</strong> <code>'False'</code></li>
</ul></li>
<li><strong><code>DEFAULT_COST_CODE</code></strong>
<ul>
<li><strong>Description:</strong> Specifies a default cost code.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>COST_CODES_PATH</code></strong> / <strong><code>S3_COST_CODES_PATH</code></strong>
<ul>
<li><strong>Description:</strong> Local or S3 path to a CSV file containing available cost codes.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>ENFORCE_COST_CODES</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>'True'</code>, makes the selection of a cost code mandatory.</li>
<li><strong>Default Value:</strong> <code>'False'</code></li>
</ul></li>
</ul>
</section>
<section id="whole-document-api-options-textract-async" class="level2">
<h2 class="anchored" data-anchor-id="whole-document-api-options-textract-async">Whole Document API Options (Textract Async)</h2>
<ul>
<li><strong><code>SHOW_WHOLE_DOCUMENT_TEXTRACT_CALL_OPTIONS</code></strong>
<ul>
<li><strong>Description:</strong> Controls whether UI options for asynchronous whole document Textract calls are displayed.</li>
<li><strong>Default Value:</strong> <code>'False'</code></li>
</ul></li>
<li><strong><code>TEXTRACT_WHOLE_DOCUMENT_ANALYSIS_BUCKET</code></strong>
<ul>
<li><strong>Description:</strong> The S3 bucket used for asynchronous Textract analysis.</li>
<li><strong>Default Value:</strong> <code>''</code></li>
</ul></li>
<li><strong><code>TEXTRACT_WHOLE_DOCUMENT_ANALYSIS_INPUT_SUBFOLDER</code></strong> / <strong><code>..._OUTPUT_SUBFOLDER</code></strong>
<ul>
<li><strong>Description:</strong> Input and output subfolders within the analysis bucket.</li>
<li><strong>Default Values:</strong> <code>'input'</code>, <code>'output'</code></li>
</ul></li>
<li><strong><code>LOAD_PREVIOUS_TEXTRACT_JOBS_S3</code></strong>
<ul>
<li><strong>Description:</strong> If set to <code>'True'</code>, the application will load data from previous Textract jobs stored in S3.</li>
<li><strong>Default Value:</strong> <code>'False'</code></li>
</ul></li>
<li><strong><code>TEXTRACT_JOBS_S3_LOC</code></strong> / <strong><code>TEXTRACT_JOBS_S3_INPUT_LOC</code></strong>
<ul>
<li><strong>Description:</strong> S3 subfolders where Textract job output and input are stored.</li>
<li><strong>Default Value:</strong> <code>'output'</code>, <code>'input'</code></li>
</ul></li>
<li><strong><code>TEXTRACT_JOBS_LOCAL_LOC</code></strong>
<ul>
<li><strong>Description:</strong> The local subfolder for storing Textract job data.</li>
<li><strong>Default Value:</strong> <code>'output'</code></li>
</ul></li>
<li><strong><code>DAYS_TO_DISPLAY_WHOLE_DOCUMENT_JOBS</code></strong>
<ul>
<li><strong>Description:</strong> Specifies the number of past days for which to display whole document Textract jobs.</li>
<li><strong>Default Value:</strong> <code>7</code></li>
</ul></li>
</ul>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/seanpedrick-case\.github\.io\/doc_redaction\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>